/*!
 * pulltorefreshjs v0.1.20
 * (c) Rafael Soto
 * Released under the MIT License.
 */
!function(e,n){"object"==typeof exports&&"undefined"!=typeof module?module.exports=n():"function"==typeof define&&define.amd?define(n):(e=e||self).PullToRefresh=n()}(this,function(){"use strict";var e={pullStartY:null,pullMoveY:null,handlers:[],styleEl:null,events:null,dist:0,state:"pending",timeout:null,distResisted:0,supportsPassive:!1,supportsPointerEvents:!!window.PointerEvent};try{window.addEventListener("test",null,{get passive(){e.supportsPassive=!0}})}catch(e){}var n,t={setupDOM:function(n){if(!n.ptrElement){var t=document.createElement("div");n.mainElement!==document.body?n.mainElement.parentNode.insertBefore(t,n.mainElement):document.body.insertBefore(t,document.body.firstChild),t.classList.add(n.classPrefix+"ptr"),t.innerHTML=n.getMarkup().replace(/__PREFIX__/g,n.classPrefix),n.ptrElement=t,"function"==typeof n.onInit&&n.onInit(n),e.styleEl||(e.styleEl=document.createElement("style"),e.styleEl.setAttribute("id","pull-to-refresh-js-style"),document.head.appendChild(e.styleEl)),e.styleEl.textContent=n.getStyles().replace(/__PREFIX__/g,n.classPrefix).replace(/\s+/g," ")}return n},onReset:function(n){n.ptrElement.classList.remove(n.classPrefix+"refresh"),n.ptrElement.style[n.cssProp]="0px",setTimeout(function(){n.ptrElement&&n.ptrElement.parentNode&&(n.ptrElement.parentNode.removeChild(n.ptrElement),n.ptrElement=null),e.state="pending"},n.refreshTimeout)},update:function(n){var t=n.ptrElement.querySelector("."+n.classPrefix+"icon"),s=n.ptrElement.querySelector("."+n.classPrefix+"text");t&&("refreshing"===e.state?t.innerHTML=n.iconRefreshing:t.innerHTML=n.iconArrow),s&&("releasing"===e.state&&(s.innerHTML=n.instructionsReleaseToRefresh),"pulling"!==e.state&&"pending"!==e.state||(s.innerHTML=n.instructionsPullToRefresh),"refreshing"===e.state&&(s.innerHTML=n.instructionsRefreshing))}},s=function(n){return e.pointerEventsEnabled&&e.supportsPointerEvents?n.screenY:n.touches[0].screenY},r=function(){var r;function i(n){var i=e.handlers.filter(function(e){return e.contains(n.target)})[0];e.enable=!!i,i&&"pending"===e.state&&(r=t.setupDOM(i),i.shouldPullToRefresh()&&(e.pullStartY=s(n)),clearTimeout(e.timeout),t.update(i))}function o(n){r&&r.ptrElement&&e.enable&&(e.pullStartY?e.pullMoveY=s(n):r.shouldPullToRefresh()&&(e.pullStartY=s(n)),"refreshing"!==e.state?("pending"===e.state&&(r.ptrElement.classList.add(r.classPrefix+"pull"),e.state="pulling",t.update(r)),e.pullStartY&&e.pullMoveY&&(e.dist=e.pullMoveY-e.pullStartY),e.distExtra=e.dist-r.distIgnore,e.distExtra>0&&(n.cancelable&&n.preventDefault(),r.ptrElement.style[r.cssProp]=e.distResisted+"px",e.distResisted=r.resistanceFunction(e.distExtra/r.distThreshold)*Math.min(r.distMax,e.distExtra),"pulling"===e.state&&e.distResisted>r.distThreshold&&(r.ptrElement.classList.add(r.classPrefix+"release"),e.state="releasing",t.update(r)),"releasing"===e.state&&e.distResisted<r.distThreshold&&(r.ptrElement.classList.remove(r.classPrefix+"release"),e.state="pulling",t.update(r)))):n.cancelable&&r.shouldPullToRefresh()&&e.pullStartY<e.pullMoveY&&n.preventDefault())}function a(){if(r&&r.ptrElement&&e.enable){if(clearTimeout(n),n=setTimeout(function(){r&&r.ptrElement&&"pending"===e.state&&t.onReset(r)},500),"releasing"===e.state&&e.distResisted>r.distThreshold)e.state="refreshing",r.ptrElement.style[r.cssProp]=r.distReload+"px",r.ptrElement.classList.add(r.classPrefix+"refresh"),e.timeout=setTimeout(function(){var e=r.onRefresh(function(){return t.onReset(r)});e&&"function"==typeof e.then&&e.then(function(){return t.onReset(r)}),e||r.onRefresh.length||t.onReset(r)},r.refreshTimeout);else{if("refreshing"===e.state)return;r.ptrElement.style[r.cssProp]="0px",e.state="pending"}t.update(r),r.ptrElement.classList.remove(r.classPrefix+"release"),r.ptrElement.classList.remove(r.classPrefix+"pull"),e.pullStartY=e.pullMoveY=null,e.dist=e.distResisted=0}}function l(){r&&r.mainElement.classList.toggle(r.classPrefix+"top",r.shouldPullToRefresh())}var d=e.supportsPassive?{passive:e.passive||!1}:void 0;return e.pointerEventsEnabled&&e.supportsPointerEvents?(window.addEventListener("pointerup",a),window.addEventListener("pointerdown",i),window.addEventListener("pointermove",o,d)):(window.addEventListener("touchend",a),window.addEventListener("touchstart",i),window.addEventListener("touchmove",o,d)),window.addEventListener("scroll",l),{onTouchEnd:a,onTouchStart:i,onTouchMove:o,onScroll:l,destroy:function(){e.pointerEventsEnabled&&e.supportsPointerEvents?(window.removeEventListener("pointerdown",i),window.removeEventListener("pointerup",a),window.removeEventListener("pointermove",o,d)):(window.removeEventListener("touchstart",i),window.removeEventListener("touchend",a),window.removeEventListener("touchmove",o,d)),window.removeEventListener("scroll",l)}}},i={distThreshold:78,distMax:80,distReload:50,distIgnore:0,mainElement:"body",triggerElement:"body",ptrElement:".ptr",classPrefix:"ptr--",cssProp:"min-height",iconArrow:"<i>O</i>",iconRefreshing:"<i>X</i>",instructionsPullToRefresh:"Pull down to refresheee",instructionsReleaseToRefresh:"Release to refreshooo",instructionsRefreshing:"Refreshingaaa",refreshTimeout:500,getMarkup:function(){return'\n<div class="__PREFIX__box">\n  <div class="__PREFIX__content">\n    <div class="__PREFIX__icon"></div>\n  </div>\n</div>\n'},getStyles:function(){return"\n.__PREFIX__ptr {\n  box-shadow: inset 0 -1px 5px -1px rgba(0, 0, 0, 0.12);\n  pointer-events: none;\n  font-size: 0.85em;\n  font-weight: bold;\n  top: 0;\n  height: 0;\n  transition: height 0.3s, min-height 0.3s;\n  text-align: center;\n  width: 100%;\n  overflow: hidden;\n  display: flex;\n  align-items: flex-end;\n  align-content: stretch;\n  background: #f2f2f2;\n}\n\n.__PREFIX__ptr.__PREFIX__refresh {\n  align-items: center;\n}\n\n.__PREFIX__box {\n  padding: 10px;\n  flex-basis: 100%;\n}\n\n.__PREFIX__pull {\n  transition: none;\n}\n\n.__PREFIX__text {\n  margin-top: .33em;\n  color: rgba(0, 0, 0, 0.3);\n}\n\n.__PREFIX__icon {\n  color: rgba(0, 0, 0, 0.3);\n  animation-name: rotate, fadeIn;\n  animation-duration: 3s, 3s;\n  animation-iteration-count: infinite, 1;\n  animation-timing-function: linear, linear;\n  animation-play-state: running, running;\n  \n}\n\n.__PREFIX__icon i {\n  background: white;\n  padding: 6px;\n  border-radius: 100%;\n}\n\n/*\nWhen at the top of the page, disable vertical overscroll so passive touch\nlisteners can take over.\n*/\n.__PREFIX__top {\n  touch-action: pan-x pan-down pinch-zoom;\n}\n\n.__PREFIX__release .__PREFIX__icon {\n  animation-play-state: running, paused;\n}\n\n\n.__PREFIX__refresh .__PREFIX__icon {\n  animation: 0.6s linear infinite rotate;\n}\n\n\n@keyframes fadeIn {\n  0% {\n    opacity: 0;\n  }  \n  \n  100% {\n    opacity: 100;\n  }\n}\n\n@keyframes rotate {\n  0% {\n  transform: rotate(0deg);\n  }\n  \n  100% {\n  transform: rotate(360deg);\n  }\n}\n\n@keyframes pulse {\n  0% {\n    box-shadow: 0 0 0 0 rgba(245,122,0, 0.4);\n  }\n  50% {\n    box-shadow: 0 0 0 8px rgba(245,122,0, 0);\n  }\n  100% {\n    box-shadow: 0 0 0 0 rgba(245,122,0, 0.4);\n  }\n}\n\n@keyframes releaseMe2 {\n  0% {\n    transform: rotate(-10deg);\n  }\n  \n  50% {\n    transform: rotate(45deg);\n  }\n\n  100% {\n    transform: rotate(-10deg);\n  }\n}\n\n @keyframes releaseMe {\n  0% {\n    transform: translateY(0);\n  }\n  \n  50% {\n    transform:  translateY(10);\n  }\n\n  100% {\n    transform:  translateY(0);\n  }\n}\n"},onInit:function(){},onRefresh:function(){return location.reload()},resistanceFunction:function(e){return Math.min(1,e/2.5)},shouldPullToRefresh:function(){return!window.scrollY}},o=["mainElement","ptrElement","triggerElement"],a=function(n){var t={};return Object.keys(i).forEach(function(e){t[e]=n[e]||i[e]}),t.refreshTimeout="number"==typeof n.refreshTimeout?n.refreshTimeout:i.refreshTimeout,o.forEach(function(e){"string"==typeof t[e]&&(t[e]=document.querySelector(t[e]))}),e.events||(e.events=r()),t.contains=function(e){return t.triggerElement.contains(e)},t.destroy=function(){clearTimeout(e.timeout);var n=e.handlers.indexOf(t);e.handlers.splice(n,1)},t};return{setPassiveMode:function(n){e.passive=n},setPointerEventsMode:function(n){e.pointerEventsEnabled=n},destroyAll:function(){e.events&&(e.events.destroy(),e.events=null),e.handlers.forEach(function(e){e.destroy()})},init:function(n){void 0===n&&(n={});var t=a(n);return e.handlers.push(t),t},_:{setupHandler:a,setupEvents:r,setupDOM:t.setupDOM,onReset:t.onReset,update:t.update}}});
//# sourceMappingURL=index.umd.min.js.map
